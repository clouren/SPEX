        -:    0:Source:spex_create_mpfr_array.c
        -:    0:Graph:spex_create_mpfr_array.gcno
        -:    0:Data:spex_create_mpfr_array.gcda
        -:    0:Runs:9
        -:    1://------------------------------------------------------------------------------
        -:    2:// SPEX_Util/spex_create_mpfr_array: create a dense mpfr array
        -:    3://------------------------------------------------------------------------------
        -:    4:
        -:    5:// SPEX_Util: (c) 2019-2021, Chris Lourenco (US Naval Academy), Jinhao Chen,
        -:    6:// Erick Moreno-Centeno, Timothy A. Davis, Texas A&M.  All Rights Reserved.
        -:    7:// SPDX-License-Identifier: GPL-2.0-or-later or LGPL-3.0-or-later
        -:    8:
        -:    9://------------------------------------------------------------------------------
        -:   10:
        -:   11:/* Purpose: This function creates a MPFR array of desired precision. It is used
        -:   12:            internally for the SPEX_matrix_allocate function */
        -:   13:
        -:   14:#include "spex_util_internal.h"
        -:   15:
    29718:   16:mpfr_t* spex_create_mpfr_array
        -:   17:(
        -:   18:    int64_t n,           // size of the array
        -:   19:    const SPEX_options *option // command options containing the prec for mpfr
        -:   20:)
        -:   21:{
        -:   22:
        -:   23:    //--------------------------------------------------------------------------
        -:   24:    // check inputs
        -:   25:    //--------------------------------------------------------------------------
        -:   26:
   29718*:   27:    if (n <= 0) {return NULL;}
   29718*:   28:    uint64_t prec = SPEX_OPTION_PREC (option) ;
        -:   29:
        -:   30:    //--------------------------------------------------------------------------
        -:   31:
    29718:   32:    mpfr_t* x = (mpfr_t*) SPEX_calloc(n, sizeof(mpfr_t));
    29718:   33:    if (!x) {return NULL;}
   371796:   34:    for (int64_t i = 0; i < n; i++)
        -:   35:    {
   343400:   36:        if (SPEX_mpfr_init2(x[i], prec) != SPEX_OK)
        -:   37:        {
     1141:   38:            SPEX_MPFR_SET_NULL(x[i]);
    14324:   39:            for (int64_t j = 0; j < n; j++)
        -:   40:            {
    13183:   41:                if ( x[j] != NULL)
        -:   42:                {
    13183:   43:                    SPEX_MPFR_CLEAR( x[j]);
        -:   44:                }
        -:   45:            }
     1141:   46:            SPEX_FREE(x);
     1141:   47:            return NULL;
        -:   48:        }
        -:   49:    }
    28396:   50:    return x;
        -:   51:}
        -:   52:
